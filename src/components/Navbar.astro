---

---

<nav class="fixed top-0 left-0 right-0 z-50 glass shadow-natural">
  <div class="container mx-auto px-4">
    <div class="flex items-center justify-between h-16">
      <!-- Logo/Brand -->
      <div class="flex items-center space-x-2">
        <a
          href="/"
          class="flex items-center space-x-2 text-blue-600 hover:text-blue-700 transition-colors"
        >
          <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
            ></path>
          </svg>
          <span class="font-bold text-xl">All About Me</span>
        </a>
      </div>

      <!-- Navigation Links -->
      <div class="hidden md:flex items-center space-x-8">
        <a
          href="/dashboard"
          class="text-gray-700 hover:text-blue-600 transition-colors font-medium"
        >
          Profile
        </a>
        <a
          href="/add-memory"
          class="text-gray-700 hover:text-blue-600 transition-colors font-medium"
        >
          Add Memory
        </a>
        <a
          href="/edit-profile"
          class="text-gray-700 hover:text-blue-600 transition-colors font-medium"
        >
          Edit Profile
        </a>
      </div>

      <!-- User Menu & Mobile Menu Button -->
      <div class="flex items-center space-x-4">
        <!-- Add Memory Button (Quick Action) -->
        <a
          href="/add-memory"
          class="hidden sm:inline-flex bg-gradient-to-r from-blue-600 to-blue-700 text-white px-4 py-2 rounded-full text-sm font-semibold hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-natural hover:shadow-natural-lg"
        >
          <svg
            class="w-4 h-4 mr-2"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 4v16m8-8H4"></path>
          </svg>
          Add Memory
        </a>

        <!-- Authentication Section -->
        <div id="auth-section" class="flex items-center space-x-2 sm:space-x-4">
          <!-- Sign In/Up Buttons (for non-authenticated users) -->
          <div id="auth-buttons" class="hidden flex-row space-x-2">
            <button
              id="signin-btn"
              class="text-gray-700 hover:text-blue-600 transition-colors font-medium text-sm sm:text-base"
            >
              Sign In
            </button>
            <button
              id="signup-btn"
              class="bg-gradient-to-r from-blue-600 to-blue-700 text-white px-3 sm:px-4 py-2 rounded-full text-sm font-semibold hover:from-blue-700 hover:to-blue-800 transition-all duration-200"
            >
              Sign Up
            </button>
          </div>

          <!-- User Menu (for authenticated users) -->
          <div id="user-menu" class="relative hidden">
            <!-- User Avatar/Button -->
            <button
              id="user-menu-button"
              class="flex items-center space-x-2 text-gray-700 hover:text-blue-600 transition-colors"
            >
              <div
                class="w-8 h-8 bg-gradient-to-r from-blue-600 to-blue-700 rounded-full flex items-center justify-center text-white font-semibold text-sm"
              >
                <span id="user-initial">?</span>
              </div>
              <svg
                class="w-4 h-4"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"></path>
              </svg>
            </button>

            <!-- Dropdown Menu -->
            <div
              id="user-dropdown"
              class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 hidden"
            >
              <div class="px-4 py-2 border-b border-gray-100">
                <p class="text-sm font-semibold text-gray-900" id="user-name">
                  Guest User
                </p>
                <p class="text-xs text-gray-500" id="user-email">
                  guest@example.com
                </p>
              </div>
              <a
                href="/dashboard"
                class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600"
              >
                <svg
                  class="w-4 h-4 inline mr-2"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                  ></path>
                </svg>
                My Profile
              </a>
              <a
                href="/edit-profile"
                class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600"
              >
                <svg
                  class="w-4 h-4 inline mr-2"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
                  ></path>
                </svg>
                Edit Profile
              </a>
              <div class="border-t border-gray-100 mt-1">
                <button
                  id="logout-btn"
                  class="block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50"
                >
                  <svg
                    class="w-4 h-4 inline mr-2"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
                    ></path>
                  </svg>
                  Sign Out
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Mobile Menu Button -->
        <button
          id="mobile-menu-button"
          class="md:hidden text-gray-700 hover:text-blue-600 transition-colors"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div
      id="mobile-menu"
      class="md:hidden hidden border-t border-blue-200 py-4"
    >
      <div class="space-y-2">
        <a
          href="/dashboard"
          class="block px-4 py-2 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors"
        >
          My Profile
        </a>
        <a
          href="/add-memory"
          class="block px-4 py-2 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors"
        >
          Add Memory
        </a>
        <a
          href="/edit-profile"
          class="block px-4 py-2 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors"
        >
          Edit Profile
        </a>
      </div>
    </div>
  </div>
</nav>

<script>
  // Navbar functionality
  class NavbarManager {
    constructor() {
      this.setupEventListeners();
      this.updateUserInfo();
    }

    setupEventListeners() {
      // User menu toggle
      const userMenuButton = document.getElementById("user-menu-button");
      const userDropdown = document.getElementById("user-dropdown");

      userMenuButton?.addEventListener("click", (e) => {
        e.stopPropagation();
        userDropdown?.classList.toggle("hidden");
      });

      // Close dropdown when clicking outside
      document.addEventListener("click", () => {
        userDropdown?.classList.add("hidden");
      });

      // Mobile menu toggle
      const mobileMenuButton = document.getElementById("mobile-menu-button");
      const mobileMenu = document.getElementById("mobile-menu");

      mobileMenuButton?.addEventListener("click", () => {
        mobileMenu?.classList.toggle("hidden");
      });

      // Logout functionality
      const logoutBtn = document.getElementById("logout-btn");
      logoutBtn?.addEventListener("click", () => {
        localStorage.removeItem("session");
        window.location.href = "/";
      });

      // Auth button functionality
      const signinBtn = document.getElementById("signin-btn");
      const signupBtn = document.getElementById("signup-btn");

      signinBtn?.addEventListener("click", () => {
        if (typeof window.showAuthModal === "function") {
          window.showAuthModal();
        }
      });

      signupBtn?.addEventListener("click", () => {
        if (typeof window.showAuthModal === "function") {
          window.showAuthModal();
        }
      });
    }

    updateUserInfo() {
      const token = localStorage.getItem("session");
      const authButtons = document.getElementById("auth-buttons");
      const userMenu = document.getElementById("user-menu");

      if (token) {
        try {
          const session = JSON.parse(atob(token));
          if (session.exp > Date.now()) {
            this.setUserInfo(session);
            authButtons?.classList.add("hidden");
            userMenu?.classList.remove("hidden");
            return;
          }
        } catch (error) {
          console.log("Invalid session token");
        }
        localStorage.removeItem("session");
      }

      // Show auth buttons for non-authenticated users
      authButtons?.classList.remove("hidden");
      userMenu?.classList.add("hidden");
    }

    setUserInfo(user: { name: string; email: string }) {
      const userInitial = document.getElementById("user-initial");
      const userName = document.getElementById("user-name");
      const userEmail = document.getElementById("user-email");

      if (userInitial)
        userInitial.textContent = user.name.charAt(0).toUpperCase();
      if (userName) userName.textContent = user.name;
      if (userEmail) userEmail.textContent = user.email;
    }
  }

  // Initialize navbar when DOM is loaded
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", () => {
      new NavbarManager();
    });
  } else {
    new NavbarManager();
  }

  // Global function to update user info from other components
  (window as any).updateNavbarUserInfo = (user: {
    name: string;
    email: string;
  }) => {
    const userInitial = document.getElementById("user-initial");
    const userName = document.getElementById("user-name");
    const userEmail = document.getElementById("user-email");

    if (userInitial)
      userInitial.textContent = user.name.charAt(0).toUpperCase();
    if (userName) userName.textContent = user.name;
    if (userEmail) userEmail.textContent = user.email;
  };
</script>

<style>
  /* Add smooth transitions */
  #user-dropdown {
    transition:
      opacity 0.2s ease-in-out,
      transform 0.2s ease-in-out;
  }

  /* Active link styling */
  .nav-link-active {
    color: rgb(37 99 235);
    font-weight: 600;
  }
</style>